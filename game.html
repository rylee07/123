<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tic Tac Toe</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#06b6d4; --muted:#94a3b8; --win:#16a34a;
      --glass: rgba(255,255,255,0.03);
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#021226 0%, #071125 60%); color:#e6eef6; display:flex; align-items:center; justify-content:center; padding:32px;
    }
    .card{
      width:min(760px, 96vw); background:linear-gradient(180deg,var(--card), rgba(8,12,20,0.9)); border-radius:14px; padding:22px; box-shadow:0 10px 30px rgba(2,6,23,0.6);
    }
    header{display:flex; align-items:center; justify-content:space-between; gap:12px}
    h1{font-size:20px; margin:0}
    .controls{display:flex; gap:8px; align-items:center}
    button{background:var(--glass); border:1px solid rgba(255,255,255,0.04); color:var(--muted); padding:8px 12px; border-radius:8px; cursor:pointer}
    button.primary{background:linear-gradient(90deg, rgba(6,182,212,0.12), rgba(6,182,212,0.06)); color:var(--accent); border-color:rgba(6,182,212,0.15)}
    .main{
      display:flex; gap:22px; margin-top:18px; align-items:flex-start; flex-wrap:wrap;
    }
    .board{
      width:360px; height:360px; display:grid; grid-template-columns:repeat(3,1fr); gap:8px; background:transparent; padding:8px;
    }
    .cell{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.15)); border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:64px; font-weight:700; color:#e6eef6; cursor:pointer; user-select:none; transition:transform .12s ease, box-shadow .12s ease;
      box-shadow: 0 6px 18px rgba(2,6,23,0.45), inset 0 -2px 6px rgba(255,255,255,0.02);
    }
    .cell:hover{transform:translateY(-4px)}
    .cell.disabled{cursor:default; opacity:0.9}
    .status{font-size:14px; color:var(--muted)}
    .panel{flex:1; min-width:200px}
    .score{display:flex; gap:12px; margin-top:12px}
    .score .box{background:rgba(255,255,255,0.03); padding:12px; border-radius:10px; text-align:center; flex:1}
    .small{font-size:12px;color:var(--muted)}
    .winner{color:var(--win); font-weight:700}
    footer{margin-top:16px; display:flex; justify-content:space-between; align-items:center}
    .highlight{background:linear-gradient(90deg, rgba(22,163,74,0.12), rgba(6,182,212,0.06)); border:1px solid rgba(22,163,74,0.12)}
    /* responsive */
    @media (max-width:720px){
      .main{flex-direction:column; align-items:center}
      .board{width:92vw; height:92vw}
    }
  </style>
</head>
<body>
  <div class="card">
    <header>
      <h1>Tic Tac Toe</h1>
      <div class="controls">
        <div class="status" id="status">Player X's turn</div>
        <button id="undoBtn">Undo</button>
        <button id="resetBtn" class="primary">Restart</button>
      </div>
    </header>

    <div class="main">
      <div class="board" id="board">
        <!-- 9 cells created by JS -->
      </div>

      <aside class="panel">
        <div class="small">Game mode</div>
        <div style="margin-top:8px; display:flex; gap:8px">
          <button id="pvpBtn" class="primary" aria-pressed="true">2 Players</button>
          <button id="cpuBtn">Play vs CPU</button>
        </div>

        <div class="score">
          <div class="box">
            <div class="small">X</div>
            <div id="scoreX">0</div>
          </div>
          <div class="box">
            <div class="small">Draws</div>
            <div id="scoreD">0</div>
          </div>
          <div class="box">
            <div class="small">O</div>
            <div id="scoreO">0</div>
          </div>
        </div>

        <div style="margin-top:14px" class="small">Tips</div>
        <ul style="margin-top:8px;color:var(--muted);padding-left:18px">
          <li>Click any empty cell to place your mark.</li>
          <li>Use <strong>Restart</strong> to start a fresh game.</li>
          <li>CPU uses a simple but decent strategy (not unbeatable).</li>
        </ul>
      </aside>
    </div>

    <footer>
      <div class="small">Made with ❤️ — Refresh to fully reset scores</div>
      <div class="small">Version 1.0</div>
    </footer>
  </div>

  <script>
    // Board state: array of 9 strings: '', 'X', or 'O'
    const boardEl = document.getElementById('board');
    const statusEl = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    const undoBtn = document.getElementById('undoBtn');
    const pvpBtn = document.getElementById('pvpBtn');
    const cpuBtn = document.getElementById('cpuBtn');
    const scoreX = document.getElementById('scoreX');
    const scoreO = document.getElementById('scoreO');
    const scoreD = document.getElementById('scoreD');

    let board = Array(9).fill('');
    let current = 'X';
    let isGameOver = false;
    let winnerCombo = null;
    let history = [];
    let scores = { X:0, O:0, D:0 };
    let vsCpu = false;

    const wins = [
      [0,1,2],[3,4,5],[6,7,8], // rows
      [0,3,6],[1,4,7],[2,5,8], // cols
      [0,4,8],[2,4,6] // diags
    ];

    function renderBoard(){
      boardEl.innerHTML = '';
      board.forEach((val, i) => {
        const btn = document.createElement('div');
        btn.className = 'cell' + (val ? ' disabled' : '');
        btn.dataset.index = i;
        btn.innerHTML = val;
        if(winnerCombo && winnerCombo.includes(i)) btn.classList.add('highlight');
        btn.addEventListener('click', onCellClick);
        boardEl.appendChild(btn);
      });
    }

    function onCellClick(e){
      const i = Number(e.currentTarget.dataset.index);
      if(isGameOver || board[i] ) return;
      makeMove(i, current);

      if(vsCpu && !isGameOver){
        // small delay for CPU
        setTimeout(() => {
          const cpuMove = pickCpuMove();
          if(cpuMove !== null) makeMove(cpuMove, 'O');
        }, 300);
      }
    }

    function makeMove(i, player){
      history.push({board: [...board], current, isGameOver});
      board[i] = player;
      checkGame();
      current = (player === 'X') ? 'O' : 'X';
      renderBoard();
      updateStatus();
    }

    function checkGame(){
      winnerCombo = null;
      for(const combo of wins){
        const [a,b,c] = combo;
        if(board[a] && board[a] === board[b] && board[a] === board[c]){
          isGameOver = true;
          winnerCombo = combo;
          const winPlayer = board[a];
          statusEl.innerHTML = `Player <span class="winner">${winPlayer}</span> wins!`;
          scores[winPlayer]++;
          updateScores();
          return;
        }
      }
      if(board.every(cell => cell)){
        isGameOver = true;
        scores.D++;
        updateScores();
        statusEl.textContent = 'Draw!';
      }
    }

    function updateStatus(){
      if(isGameOver) return;      
      statusEl.textContent = `Player ${current}'s turn`;
    }

    function updateScores(){
      scoreX.textContent = scores.X;
      scoreO.textContent = scores.O;
      scoreD.textContent = scores.D;
    }

    function resetGame(full=false){
      board = Array(9).fill('');
      current = 'X';
      isGameOver = false;
      winnerCombo = null;
      history = [];
      renderBoard();
      updateStatus();
      if(full){ scores = {X:0,O:0,D:0}; updateScores(); }
    }

    undoBtn.addEventListener('click', () => {
      if(history.length === 0) return;
      const last = history.pop();
      board = last.board;
      current = last.current;
      isGameOver = last.isGameOver;
      winnerCombo = null;
      renderBoard();
      updateStatus();
    });

    resetBtn.addEventListener('click', () => resetGame());

    pvpBtn.addEventListener('click', () => { vsCpu = false; pvpBtn.classList.add('primary'); cpuBtn.classList.remove('primary'); pvpBtn.setAttribute('aria-pressed','true'); cpuBtn.setAttribute('aria-pressed','false'); resetGame(); });
    cpuBtn.addEventListener('click', () => { vsCpu = true; cpuBtn.classList.add('primary'); pvpBtn.classList.remove('primary'); cpuBtn.setAttribute('aria-pressed','true'); pvpBtn.setAttribute('aria-pressed','false'); resetGame(); });

    // basic CPU: try win, block, take center, take corner, take side
    function pickCpuMove(){
      // 1: can CPU win?
      for(let i=0;i<9;i++) if(!board[i]){
        const copy = [...board]; copy[i] = 'O';
        if(isWinning(copy,'O')) return i;
      }
      // 2: can block X?
      for(let i=0;i<9;i++) if(!board[i]){
        const copy = [...board]; copy[i] = 'X';
        if(isWinning(copy,'X')) return i;
      }
      // 3: take center
      if(!board[4]) return 4;
      // 4: take any corner
      const corners = [0,2,6,8].filter(i => !board[i]);
      if(corners.length) return corners[Math.floor(Math.random()*corners.length)];
      // 5: take any side
      const sides = [1,3,5,7].filter(i=>!board[i]);
      if(sides.length) return sides[Math.floor(Math.random()*sides.length)];
      return null;
    }

    function isWinning(arr, player){
      return wins.some(combo => combo.every(i => arr[i]===player));
    }

    // initialize
    for(let i=0;i<9;i++) boardEl.appendChild(document.createElement('div'));
    resetGame(true);
    renderBoard();

    // keyboard support: digits 1-9 to play
    window.addEventListener('keydown', (e)=>{
      if(e.key >= '1' && e.key <= '9'){
        const index = Number(e.key) - 1; // 1 maps to 0
        if(!isGameOver && !board[index]) makeMove(index, current);
        if(vsCpu && !isGameOver){ setTimeout(()=>{ const cpuMove = pickCpuMove(); if(cpuMove!==null) makeMove(cpuMove,'O'); }, 250); }
      }
    });
  </script>
</body>
</html>
